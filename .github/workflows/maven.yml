name: Java CI with Maven

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Print environment variables
      run: |
        echo "CI_REPOSITORY_SLUG=$CI_REPOSITORY_SLUG"
        echo "CI_REPOSITORY_OWNER=$CI_REPOSITORY_OWNER"
        echo "CI_REPOSITORY_OWNER_SLUG=$CI_REPOSITORY_OWNER_SLUG"
        echo "CI_REPOSITORY_NAME=$CI_REPOSITORY_NAME"
        echo "CI_REPOSITORY_NAME_SLUG=$CI_REPOSITORY_NAME_SLUG"
        echo "CI_REPOSITORY=$CI_REPOSITORY"
        echo "CI_REF_SLUG=$CI_REF_SLUG"
        echo "CI_ACTION_REF_NAME=$CI_ACTION_REF_NAME"
        echo "CI_ACTION_REF_NAME_SLUG=$CI_ACTION_REF_NAME_SLUG"
        echo "CI_REF_NAME=$CI_REF_NAME"
        echo "CI_REF_NAME_SLUG=$CI_REF_NAME_SLUG"
        echo "CI_REF=$CI_REF"
        echo "CI_HEAD_REF_SLUG=$CI_HEAD_REF_SLUG"
        echo "CI_HEAD_REF=$CI_HEAD_REF"
        echo "CI_BASE_REF_SLUG=$CI_BASE_REF_SLUG"
        echo "CI_BASE_REF=$CI_BASE_REF"
        echo "CI_SHA_SHORT=$CI_SHA_SHORT"
        echo "CI_SHA=$CI_SHA"
        echo "CI_ACTOR=$CI_ACTOR"
        echo "CI_EVENT_NAME=$CI_EVENT_NAME"
        echo "CI_RUN_ID=$CI_RUN_ID"
        echo "CI_RUN_NUMBER=$CI_RUN_NUMBER"
        echo "CI_WORKFLOW=$CI_WORKFLOW"
        echo "CI_ACTION=$CI_ACTION"  
    - name: Set up JDK 1.8
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    - name: Cache Maven packages
      uses: actions/cache@v2
      with:
        path: ~/.m2
        key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}
        restore-keys: ${{ runner.os }}-m2
    - name: Build with Maven
      env:
        LINKANDTRACK_USER: ${{ secrets.LINKANDTRACK_USER}}
        LINKANDTRACK_TOKEN: ${{ secrets.LINKANDTRACK_TOKEN}}
      run: mvn --batch-mode --update-snapshots verify
